### 12.3 设计和技术目标
#### 12.3.1 二进制分帧层
> ![image](https://raw.githubusercontent.com/weikano/NoteResources/master/WEB-Guide/6.png)
>
> HTTP 1.x以换行符作为纯文本的分隔符，二HTTP 2.0将所有传输的信息分割为更小的消息和帧，并对它们采用二进制格式的编码

#### 12.3.2 流、消息和帧
> - 流：已建立连接上的双向字节流
> - 消息：与逻辑消息对应的完整的一系列数据帧
> - 帧：HTTP 2.0通信的最小单位，每个帧包含帧首部，至少也会标识出当前帧所属的流
> ![image](https://raw.githubusercontent.com/weikano/NoteResources/master/WEB-Guide/7.png)
>
> 所有HTTP 2.0通信都在一个连接上完成，这个连接可以承载任意数量的双向数据流。相应的，每个数据流以消息的形式发送，而消息由一或多个帧组成，可以乱序发送，然后根据每个帧首部的流标识重新组装
>
> - 所有连接都在一个TCP连接上完成
> - 流是连接中的一个虚拟管道，可以承载双向的消息；每个流都有一个唯一的整数标识符
> - 消息是指逻辑上的HTTP消息，比如请求、响应等，由一个或多个帧组成
> - 帧是最小的数据单位，承载着特定类型的数据，如HTTP首部、负荷等

#### 12.3.3 多向请求与响应
> - 可以并行交错的发送请求，请求之间互不影响
> - 可以并行交错的发送响应
> - 只使用一个连接即可发送多个请求和响应
> - 消除不必要的延迟，从而减少页面加载时间
> - 不必再绕过HTTP 1.X限制而多做很多工作
> - 解决队首阻塞的……

#### 12.3.4 请求优先级
> 每个流都可以带有一个31bit的优先值，0为最高

#### 12.3.5 每个来源一个连接
- 所有数据流的优先次序始终如一
- 压缩上下文单一使得压缩效果更好
- TCP连接减少使得网络拥塞状况改观
- 慢启动时间减少，拥塞和丢包恢复速度更快

#### 12.3.6 流量控制
- 基于每一跳进行，而非到端的控制
- 基于窗口更新帧进行，即接收方广播自己准备接收某个字节流的多少字节，以及对整个连接要接收多少字节
- 窗口大小通过WINDOW_UPDATE帧更新，指定流ID和窗口大小递增值
- 由方向性，能根据自己的情况为每个流乃至整个连接设置任意窗口大小
- 接收方可以禁用

#### 12.3.7 服务器推送
- 客户端可以缓存推送过来的资源
- 客户端可以拒绝推送过来的资源
- 推送资源可以由不同页面共享
- 服务器可以按照优先级推送资源

#### 12.3.8 首部压缩
- 客户端和服务器端使用首部表来追踪和存储之前发送的键值对，对于相同的数据，不再通过每次请求和响应发送
- 首部表在连接存续期间始终存在，由客户端和服务器端共同渐进更新
- 每个新的首部键值对要么追加值当前表的尾部，要么替换表的值

### 12.4 二进制分帧简介
> 二级制分帧后，HTTP2.0的帧首部只占8个字节
#### 12.4.1 发起新流
> 发送应用数据之前，必须创建一个新流并随之发送相应的元数据，比如优先级流、HTTP首部等。客户端和服务器端都可以发起新流：C端通过HEADERS帧，S端通过PUSH_PROMISE帧。C端发起的流就有偶数ID，S端发起的流为奇数ID

#### 12.4.2 发送应用数据
#### 12.4.3 HTTP 2.0帧数据流分析

